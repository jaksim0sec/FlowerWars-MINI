<head>
    <title>ê°œë‚˜ë¦¬ì›Œì¦ˆ:MINI â–º Î²</title>
    <link rel="shortcut icon" href="https://ifh.cc/g/69rynC.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
</head>

<body>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            user-select: none;
            font-family: "Jua", sans-serif;
            font-style: normal;
        }

        .object {
            position: absolute;
        }

        #ingame_world {
            width: 100vw;
            height: 100vh;
            margin: 0;
            padding: 0;
            overflow: hidden;
            position: relative;
            background-color: #e6e6e6;
            display: flex;
            justify-content: center;
        }

        #ingame_world_board {
            width: auto;
            height: auto;
            box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            background-color: #E2E2E2;
        }

        .tile {
            width: 98px;
            height: 98px;
            margin: 1px;
            background-color: #DDD1C3;
            border-radius: 15px;
            position: relative;
            box-shadow: inset -5px -5px 4px #CBB39B95;
            transition: all 0.5s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tile:hover {
            transform: scale(1) translateY(-12px);
            filter: brightness(1.02);
            box-shadow: 0px 8px 10px #00000020, inset -5px -5px 6px #CBB39B99;
        }


        .tile-updated {
            filter: brightness(0.9);
            transform: scale(0.95);
            transition: all 0.4s ease;
        }

        .tile-updated-end {
            filter: none;
            transform: none;
            transition: all 0.3s ease;
        }

        .tile.edge-top {
            margin-top: 0;
        }

        .tile.edge-left {
            margin-left: 0;
        }

        .tile.edge-bottom {
            margin-bottom: 0;
        }

        .tile.edge-right {
            margin-right: 0;
        }

        .ìºë¦­í„° {
            width: 55px;
            /*height: 90px;*/
            transform-origin: bottom;
            margin-bottom: 62px;
            transition: all 0.3s ease;
            animation: shake 0.5s ease-in-out;
            /*filter: contrast(1.1);*/
        }

        .w {
            transition: all 0.5s ease;
        }

        @keyframes jump {
            0% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-10px);
                animation-timing-function: ease-out;
            }

            50% {
                transform: translateY(-10px);
            }

            100% {
                transform: translateY(0);
                animation-timing-function: ease-in;
            }

        }

        @keyframes shake {
            0% {
                transform: rotate(-5deg) translateY(-2px);
            }

            25% {
                transform: rotate(10deg) translateY(2px);
            }

            75% {
                transform: rotate(-5deg) translateY(-2px);
            }

            100% {
                transform: rotate(0deg)translateY(0px);
            }
        }

        @keyframes ì£½ìŒì•„êµ° {
            0% {
                transform: rotate(0deg) translateY(0);
                opacity: 1;
            }

            50% {
                transform: rotate(90deg) translateY(10);
                opacity: 1;
            }

            100% {
                transform: rotate(90deg) translateY(10px);
                opacity: 0;
            }
        }

        @keyframes ì£½ìŒì êµ° {
            0% {
                transform: rotate(0deg) translateY(0);
                opacity: 1;
            }

            50% {
                transform: rotate(-90deg) translateY(10);
                opacity: 1;
            }

            100% {
                transform: rotate(-90deg) translateY(10px);
                opacity: 0;
            }
        }

        .fixed-window {
            padding: 2%;
            position: absolute;
            border-radius: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.5);
            color: #fff;
            font-family: Arial, sans-serif;
            font-size: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .fixed-window {
            padding: 2%;
            position: absolute;
            border-radius: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.5);
            color: #fff;
            font-family: Arial, sans-serif;
            font-size: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .fixed-window:hover {
            transform: scale(1.05);
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.7);
        }

        button {
            width: 120px;
            padding: 10px 20px;
            margin: 10px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
            font-size: 14px;
            color: white;
            background-color: black;
            font-weight: bold;
        }

        .button:hover {
            transform: scale(1.05);
        }

        .particle {
            position: absolute;
            border-radius: 5px;
            pointer-events: none;
            opacity: 1;
            transition: opacity 0.8s ease;
            width: 5px;
            height: 5px;
            background-color: rgba(255, 255, 255, 0.8);
            animation: explosion 1s
                /*cubic-bezier(0.68, -0.55, 0.27, 1.55);*/
        }

        @keyframes explosion {
            0% {
                transform: translate(0, 0) scale(1) rotate(0deg);
                opacity: 1;
            }

            50% {
                transform: translate(var(--offsetX), var(--offsetY)) scale(1.2) rotate(180deg);
                opacity: 0.7;
            }

            100% {
                transform: translate(calc(var(--offsetX) * 1.5), calc(var(--offsetY) * 1.5)) scale(0.5) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes ì¹¨ì…ì„±ê³µ {
            0% {
                filter: brightness(1.1) contrast(1.1);
            }

            50% {
                filter: brightness(1.5) contrast(1.1);
                transform: translateY(-5px);
            }

            100% {
                filter: brightness(1) contrast(1);
                transform: translateY(0px);
                opacity: 0;
            }
        }

        .damageShow {
            position: absolute;
            z-index: -1;
            color: red;
        }

        .char_title {
            transition: all 1s ease;
        }

        #score_board {
            width: 40%;
            height: 40px;
            position: absolute;
            top: 20px;
            display: flex;
            /*box-shadow: insest 4px 4px 5px #938C85;*/
            border-radius: 50px;
        }

        #score_board div {
            height: 100%;
            transition: all 0.5s ease;
            color: white;
            display: flex;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
        }

        #score_ì êµ° {
            background-color: #FF5947;
            width: 50%;
            border-top-left-radius: 50px;
            border-bottom-left-radius: 50px;
            justify-content: right;
            padding-right: 10px;
            flex-grow: 0;
            flex-basis: 50%;
        }

        #score_ì•„êµ° {
            background-color: #4244CC;
            flex-grow: 1;
            flex-basis: 50%;
            border-top-right-radius: 50px;
            border-bottom-right-radius: 50px;
            justify-content: left;
            padding-left: 10px;
        }

        .waveAlert {
            opacity: 0;
            width: 100%;
            height: 30%;
            background-color: #00000099;
            color: white;
            font-size: 55px;
            font-weight: bold;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            top: 50%;
            right: 50%;
            transform: translateY(-50%) /*rotate(45deg)*/ translateX(50%);
            animation: waveAlert 2.5s ease;
            backdrop-filter: blur(2px);
        }

        @keyframes waveAlert
        {
            0% {
                opacity: 0;
            }

            30% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .winOrnot {
            width: 100%;
            height: 40%;
            background-color: #00000099;
            color: white;
            font-size: 85px;
            font-weight: bold;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            top: 50%;
            right: 50%;
            transform: translateY(-50%) /*rotate(45deg)*/ translateX(50%);
            animation: winOrnot 2.5s ease;
            backdrop-filter: blur(2px);
        }

        @keyframes winOrnot
        {
            0% {
                opacity: 0;
            }

            30% {
                opacity: 0.5; 
                filter: brightness(0.9);
            }

            100% {
                opacity: 1;
            }
        }
    </style>

    <div id="ingame_world" class="object">
        <div id="ingame_world_board" class="object"></div>
        <div id="ingame_world_menu">
            <div class="fixed-window" id="status" style="bottom: 2%; left: 1%; min-width: 25%; min-height: 20%;">
                [ ê°œë°œì ë©”ë‰´ ]
                <button
                    onclick="ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([{x: 2, y: 2, ê³ ìœ ì´ë¦„: `ê°œë‚˜ë¦¬ìš©ì‚¬${counter}`, íƒ€ì…: 'cha', ì¢…ì¡±: 'ê°œë‚˜ë¦¬í­íƒ„ë³‘', íŒ€: 'ì êµ°'}]); counter ++;ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([{x: 2, y: 4, ê³ ìœ ì´ë¦„: `ê°œë‚˜ë¦¬ìš©ì‚¬${counter}`, íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'}]); counter ++;ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([{x: 11, y: 3, ê³ ìœ ì´ë¦„: `ê°œë‚˜ë¦¬ìš©ì‚¬${counter}`, íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'}]); counter ++;ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([{x: 10, y: 3, ê³ ìœ ì´ë¦„: `ê°œë‚˜ë¦¬ìš©ì‚¬${counter}`, íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'}]); counter ++;">ìºë¦­í„°ìƒì„±</button>
                <button onclick="í–‰ë™ê³„ì‚°(ê²Œì„í˜„í™©.ìºë¦­í„°, 'ëª¨ë‘');">ë‹¨ì¼ê°€ì†í™”</button>
            </div>
        </div>
        <div id="score_board">
            <div id="score_ì êµ°">50</div>
            <div id="score_ì•„êµ°">50</div>
        </div>
    </div>

    <script>

        let counter = 17;
        //ë°ì´í„° 
        const ìºë¦­í„°ì´ë¯¸ì§€URL =
        {
            ê°œë‚˜ë¦¬ìš©ì‚¬: {cha: {ì•„êµ°: `https://ifh.cc/g/Zp3tjP.png`, ì êµ°: 'https://ifh.cc/g/G22rfc.png'}, w: 'https://ifh.cc/g/HjCVzp.png'},
            í…ŒìŠ¤íŠ¸: {ì•„êµ°: ``, ì êµ°: ''},
            ì êµ°ê¸°ì§€: ``,
            ì•„êµ°ê¸°ì§€: ``,
            ê°œë‚˜ë¦¬í­íƒ„ë³‘: {ì•„êµ°: `https://ifh.cc/g/ZlTzJF.png`, ì êµ°: 'https://ifh.cc/g/sKYtLq.png'}

        }
        const ìºë¦­í„°íŠ¹ì§•ì„¤ì • = {ê°œë‚˜ë¦¬ìš©ì‚¬: {ì²´ë ¥: 4, ê³µê²©ë ¥: 1}, ì êµ°ê¸°ì§€: {ì²´ë ¥: 7, ê³µê²©ë ¥: 0}, ì•„êµ°ê¸°ì§€: {ì²´ë ¥: 7, ê³µê²©ë ¥: 0}, ê°œë‚˜ë¦¬í­íƒ„ë³‘: {ì²´ë ¥: 1, ê³µê²©ë ¥: 8}, }
        // ì„ ì–¸


        //ì´ˆê¸°object ì •ì˜í˜•ì‹ = [x , y , ê³ ìœ ì´ë¦„ , íƒ€ì…, ì¢…ì¡±, íŒ€, ì²´ë ¥]
        //í›„ê¸°object ì •ì˜í˜•ì‹ = ê³ ìœ ì´ë¦„ : {ê³ ìœ ì´ë¦„, íƒ€ì…, ì¢…ì¡±, íŒ€ , ì²´ë ¥ , x, y}
        let ê²Œì„í˜„í™© = {
            ë§µí¬ê¸°: [12, 5], object:
                [{x: 1, y: 3, ê³ ìœ ì´ë¦„: 'ì êµ°ê¸°ì§€', íƒ€ì…: 'obj', ì¢…ì¡±: 'ì êµ°ê¸°ì§€', íŒ€: 'ì êµ°', ì²´ë ¥: ìºë¦­í„°íŠ¹ì§•ì„¤ì •.ì êµ°ê¸°ì§€.ì²´ë ¥},
                {x: 12, y: 3, ê³ ìœ ì´ë¦„: 'ì•„êµ°ê¸°ì§€', íƒ€ì…: 'obj', ì¢…ì¡±: 'ì•„êµ°ê¸°ì§€', íŒ€: 'ì•„êµ°', ì²´ë ¥: ìºë¦­í„°íŠ¹ì§•ì„¤ì •.ì•„êµ°ê¸°ì§€.ì²´ë ¥},
                {x: 11, y: 2, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬1', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'},
                {x: 11, y: 3, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬2', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'},
                {x: 11, y: 4, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬3', íƒ€ì…: 'cha', ì¢…ì¡±: 'ê°œë‚˜ë¦¬í­íƒ„ë³‘', íŒ€: 'ì•„êµ°'},
                {x: 2, y: 3, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬4', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'},
                {x: 3, y: 4, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬5', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'},
                {x: 2, y: 5, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬6', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'},
                {x: 2, y: 2, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬7', íƒ€ì…: 'cha', ì¢…ì¡±: 'ê°œë‚˜ë¦¬í­íƒ„ë³‘', íŒ€: 'ì êµ°'},
                {x: 2, y: 1, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬8', íƒ€ì…: 'cha', ì¢…ì¡±: 'ê°œë‚˜ë¦¬í­íƒ„ë³‘', íŒ€: 'ì êµ°'},
                {x: 11, y: 5, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬9', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'},
                {x: 11, y: 1, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬10', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'},
                {x: 2, y: 4, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬11', íƒ€ì…: 'cha', ì¢…ì¡±: 'ê°œë‚˜ë¦¬í­íƒ„ë³‘', íŒ€: 'ì êµ°'},
                {x: 10, y: 2, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬12', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'},
                {x: 9, y: 2, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬13', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì•„êµ°'},
                {x: 3, y: 2, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬14', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'},
                {x: 3, y: 5, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬15', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'},
                {x: 3, y: 1, ê³ ìœ ì´ë¦„: 'ê°œë‚˜ë¦¬ìš©ì‚¬16', íƒ€ì…: 'chaw', ì¢…ì¡±: 'ê°œë‚˜ë¦¬ìš©ì‚¬', íŒ€: 'ì êµ°'},
                ],
            board: [], ìºë¦­í„°: [], ë€íŒ: [], ì ìˆ˜: {ì êµ°: 2, ì•„êµ°: 2}, ì›¨ì´ë¸Œ: 1
        };
        let SYsetting = {eff: 3};
        let SYmouse = {x: 0, y: 0};
        let SYboardDrag = {
            isDragging: false,
            startX: 0,
            startY: 0,
            initialX: 0,
            initialY: 0
        };

        // ì •ì˜í•¨ìˆ˜
        function HTML(name) {return document.querySelector(name);}

        // ê¸°ë³¸í•¨ìˆ˜  
        document.addEventListener('mousemove', (event) => {
            SYmouse.x = event.clientX;
            SYmouse.y = event.clientY;
            //ë³´ë“œíŒ ë“œë˜ê·¸
            if (SYboardDrag.isDragging) {
                const dx = event.clientX - SYboardDrag.startX;
                const dy = event.clientY - SYboardDrag.startY;
                const board = HTML("#ingame_world_board");
                board.style.left = (SYboardDrag.initialX + dx) + 'px';
                board.style.top = (SYboardDrag.initialY + dy) + 'px';
            }
        });

        document.addEventListener('mousedown', (event) => {
            //ë³´ë“œíŒ ë“œë˜ê·¸
            SYboardDrag.isDragging = true;
            SYboardDrag.startX = event.clientX;
            SYboardDrag.startY = event.clientY;
            const board = HTML("#ingame_world_board");
            SYboardDrag.initialX = parseInt(board.style.left || 0);
            SYboardDrag.initialY = parseInt(board.style.top || 0);
        });

        document.addEventListener('mouseup', () => {
            SYboardDrag.isDragging = false;
        });

        // ì¸ê²Œì„ í•¨ìˆ˜
        function í­ë°œ(x, y) {
            const colors = ['#ff4500', '#ff8c00', '#ffd700', '#ffa500', '#ff6347'];
            const numParticles = 20;
            const explosionRadius = 150;

            const fireworkContainer = document.createElement('div');
            fireworkContainer.style.position = 'absolute';
            fireworkContainer.style.top = 0;
            fireworkContainer.style.left = 0;
            document.body.appendChild(fireworkContainer);

            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                const size = Math.random() * 10 + 5;
                const color = colors[Math.floor(Math.random() * colors.length)];

                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * explosionRadius;
                const offsetX = distance * Math.cos(angle);
                const offsetY = distance * Math.sin(angle);

                particle.className = 'particle';
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.backgroundColor = color;
                particle.style.left = `${x - size / 2}px`;
                particle.style.top = `${y - size / 2}px`;
                particle.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
                particle.style.setProperty('--offsetX', `${offsetX}px`);
                particle.style.setProperty('--offsetY', `${offsetY}px`);
                particle.style.animation = 'explosion 1s forwards';

                fireworkContainer.appendChild(particle);

                particle.addEventListener('animationend', () => {
                    particle.remove();
                    if (fireworkContainer.children.length === 0) {
                        fireworkContainer.remove();
                    }
                });
            }
        }

        //console.log(ê²Œì„í˜„í™©)
        function ë³´ë“œíŒìƒì„±(w, h) {
            const board = HTML("#ingame_world_board");
            board.innerHTML = "";
            const boardWidth = w * 100 - 2;
            const boardHeight = h * 100 - 2;
            const initialLeft = Math.floor((window.innerWidth - boardWidth) / 2);
            const initialTop = Math.floor((window.innerHeight - boardHeight) / 2);
            board.style.left = `${initialLeft}px`;
            board.style.top = `${initialTop}px`;
            for (let hh = 0; hh < h; hh++) {
                const row = document.createElement("div");
                row.style.display = "flex";
                row.style.width = `${boardWidth}px`;
                for (let ww = 0; ww < w; ww++) {
                    const tile = document.createElement("div");
                    tile.className = "tile";
                    tile.id = `tile_${ww + 1}_${hh + 1}`;
                    if (hh === 0) tile.classList.add("edge-top");
                    if (ww === 0) tile.classList.add("edge-left");
                    if (hh === h - 1) tile.classList.add("edge-bottom");
                    if (ww === w - 1) tile.classList.add("edge-right");
                    ê²Œì„í˜„í™©.board[hh * w + ww + 1] = "";
                    ê²Œì„í˜„í™©.ë€íŒ[hh * w + ww + 1] = ['', 0];
                    if ((hh + ww) % 2 === 0) {
                        tile.style.backgroundColor = "#F0EBE6";
                    }

                    row.appendChild(tile);
                }
                board.appendChild(row);
            }
            //console.log(ê²Œì„í˜„í™©.board);
        }


        async function ì˜¤ë¸Œì íŠ¸ê´€ë¦¬(list) {
            //console.log(list);

            for (let i = 0; i < list.length; i++) {
                const ëŒ€ìƒíƒ€ì¼ = HTML(`#tile_${list[i].x}_${list[i].y}`);
                //console.log(list[i]);
                //console.log(list[i].html);
                //if (list[i].html){console.log('ê³ ë¼ë‹ˆ')}

                //console.log(list[i].x)
                //console.log(`#tile_${list[i].x}_${list[i].y}`)
                //console.log('â–¶â–¶')
                let ëŒ€ìƒíƒ€ì¼ìš”ì†Œ = '';
                const ì„¤ì •ìš”ì†Œ = list[i];
                // ìˆ˜ë™ html ìˆ˜ì •
                if ('html' in ì„¤ì •ìš”ì†Œ) {
                    ëŒ€ìƒíƒ€ì¼.innerHTML = ì„¤ì •ìš”ì†Œ.html;
                }
                else { // ìë™ html ìƒì„±
                    //console.log(ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±] + '/' + ì„¤ì •ìš”ì†Œ.ì¢…ì¡±)
                    //console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ +'/'+ì„¤ì •ìš”ì†Œ.íŒ€)
                    //console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ + '/' + ì„¤ì •ìš”ì†Œ.íŒ€)
                    if (!(Object.keys(ì„¤ì •ìš”ì†Œ).includes('ì²´ë ¥'))) {ì„¤ì •ìš”ì†Œ.ì²´ë ¥ = ìºë¦­í„°íŠ¹ì§•ì„¤ì •[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].ì²´ë ¥;}
                    if (ì„¤ì •ìš”ì†Œ.íƒ€ì… === 'obj') {
                        ëŒ€ìƒíƒ€ì¼ìš”ì†Œ = `<img src="${ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±]}" id="${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}" class="object" alt="${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}">`;
                    }
                    else if (ì„¤ì •ìš”ì†Œ.íƒ€ì… === 'cha') {
                        ëŒ€ìƒíƒ€ì¼ìš”ì†Œ = `
                            <img src="${ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±][ì„¤ì •ìš”ì†Œ.íŒ€]}" id="${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}" class="ìºë¦­í„°" alt="${ì„¤ì •ìš”ì†Œ.íŒ€}">
                        `;
                    }
                    else if (ì„¤ì •ìš”ì†Œ.íƒ€ì… === 'chaw') {
                        if (ì„¤ì •ìš”ì†Œ.íŒ€ === "ì•„êµ°") {
                            //console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ + '/' + ì„¤ì •ìš”ì†Œ.íŒ€)
                            ëŒ€ìƒíƒ€ì¼ìš”ì†Œ = `
                            <img src="${ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].cha[ì„¤ì •ìš”ì†Œ.íŒ€]}" id="${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}" class="ìºë¦­í„°" alt="${ì„¤ì •ìš”ì†Œ.íŒ€}" style = "position:absolute;">
                            <img src="${ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].w}" style = "position:absolute;left:5px;width:30px;bottom:45px;transform:rotate(-45deg);" id="w_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}" class = "w"/>
                        `;
                        }
                        else {
                            ëŒ€ìƒíƒ€ì¼ìš”ì†Œ = `
                            <img src="${ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].cha[ì„¤ì •ìš”ì†Œ.íŒ€]}" id="${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}" class="ìºë¦­í„°" alt="${ì„¤ì •ìš”ì†Œ.íŒ€}" style = "position:absolute;">
                                <img src="${ìºë¦­í„°ì´ë¯¸ì§€URL[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].w}" style = "position:absolute;right:5px;width:30px;bottom:45px;transform:rotate(45deg) scaleX(-1);" id="w_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}" class = "w"/>
                            `;
                        }
                    };
                    HTML(`#tile_${list[i].x}_${list[i].y}`).innerHTML = ëŒ€ìƒíƒ€ì¼ìš”ì†Œ;
                    HTML(`#tile_${list[i].x}_${list[i].y}`).innerHTML += `<div id="title_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}"  style = "position:absolute; bottom: 8px; font-weight:bold;font-size:12px;" class = "char_title">${ì„¤ì •ìš”ì†Œ.ì¢…ì¡±}</div><div style="position:absolute;bottom:22px;color:${(ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì êµ°') ? '#5F2308' : '#1D1E6A'}; font-size:13px;" id = "ì²´ë ¥ë°”_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}">${"â—†".repeat(ì„¤ì •ìš”ì†Œ.ì²´ë ¥)}</div>`;
                    /*console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„+'/'+ì„¤ì •ìš”ì†Œ.ì²´ë ¥)
                    // í›„ê¸° object ì •ì˜ í˜•ì‹: [ê³ ìœ ì´ë¦„, íƒ€ì…, ì¢…ì¡±, íŒ€, ì²´ë ¥, x, y]
                    //console.log('ì˜¤ë¸Œì íŠ¸ê´€ë¦¬ í•­ëª© ' + Object.keys(ê²Œì„í˜„í™©.ìºë¦­í„°).length)*/
                    let j = 1;
                    for (j = 1; j - 1 < Object.keys(ê²Œì„í˜„í™©.ìºë¦­í„°).length; j++) {
                        //console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ + 'J:' + j);
                        if (ê²Œì„í˜„í™©.ìºë¦­í„°[Object.keys(ê²Œì„í˜„í™©.ìºë¦­í„°)[j - 1]].ê³ ìœ ì´ë¦„ === ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„) {
                            break;
                        }
                    }
                    //console.log(ê²Œì„í˜„í™©.ìºë¦­í„° +'/' + ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„)
                    //j > Object.keys(ê²Œì„í˜„í™©.ìºë¦­í„°).length
                    if (j > Object.keys(ê²Œì„í˜„í™©.ìºë¦­í„°).length) {
                        //console.log('ìƒˆë¡œìš´ í•­ëª© ì¶”ê°€ë¨' + ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„)
                        ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„] = {
                            ê³ ìœ ì´ë¦„: ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„,
                            íƒ€ì…: ì„¤ì •ìš”ì†Œ.íƒ€ì…,
                            ì¢…ì¡±: ì„¤ì •ìš”ì†Œ.ì¢…ì¡±,
                            íŒ€: ì„¤ì •ìš”ì†Œ.íŒ€,
                            ì²´ë ¥: ìºë¦­í„°íŠ¹ì§•ì„¤ì •[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].ì²´ë ¥,
                            x: ì„¤ì •ìš”ì†Œ.x,
                            y: ì„¤ì •ìš”ì†Œ.y
                        };
                    }
                    else {
                        //console.log('ì›ë˜ í•­ëª© ìˆ˜ì •ë¨' + ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„)
                        ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„].x = ì„¤ì •ìš”ì†Œ.x;
                        ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„].y = ì„¤ì •ìš”ì†Œ.y;
                    }
                }
                //console.log(`${ì„¤ì •ìš”ì†Œ.x} , ${ì„¤ì •ìš”ì†Œ.y} ì˜ ê°’ì´ ${ëŒ€ìƒíƒ€ì¼.innerHTML}`)
                ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] = ëŒ€ìƒíƒ€ì¼.innerHTML;
                //console.log('ë³´ë“œíŒí˜„í™©' + ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]])

                // íƒ€ì¼ ì—…ë°ì´íŠ¸ íš¨ê³¼
                //console.log(ëŒ€ìƒíƒ€ì¼.innerHTML)
                ëŒ€ìƒíƒ€ì¼.classList.add("tile-updated");
                setTimeout(() => {
                    ëŒ€ìƒíƒ€ì¼.classList.remove("tile-updated");
                    ëŒ€ìƒíƒ€ì¼.classList.add("tile-updated-end");
                    setTimeout(() => {
                        ëŒ€ìƒíƒ€ì¼.classList.remove("tile-updated-end");
                    }, 450);
                }, 450);
            }
            //console.log('â–¶ì˜¤ë¸Œì íŠ¸ê´€ë¦¬ ë')
        }


        function ì£¼ë³€ê³„ì‚°(x, y, ë°©í–¥) {
            if (ë°©í–¥ === 'left') {return [x - 1, y];}
            else if (ë°©í–¥ === 'right') {return [x + 1, y];}
            else if (ë°©í–¥ === 'down') {return [x, y + 1];}
            else if (ë°©í–¥ === 'up') {return [x, y - 1];}
            else if (ë°©í–¥ === '+') {return [[x - 1, y], [x + 1, y], [x, y + 1], [x, y - 1]];}
            else if (ë°©í–¥ === '*') {return [[x - 1, y + 1], [x + 1, y - 1], [x + 1, y + 1], [x - 1, y - 1]];}
        }

        function ì˜¤ë¸Œì íŠ¸ì´ë™(ëŒ€ìƒ, ë°©í–¥) {
            const ì›ë˜ìœ„ì¹˜ = {x: ëŒ€ìƒ.x, y: ëŒ€ìƒ.y}
            const ì´ë™ìœ„ì¹˜ = ì£¼ë³€ê³„ì‚°(ëŒ€ìƒ.x, ëŒ€ìƒ.y, ë°©í–¥);
            if (ì´ë™ìœ„ì¹˜ && !(ëŒ€ìƒ.íŒ€ == 'ì•„êµ°' && ëŒ€ìƒ.x == 1) && !(ëŒ€ìƒ.íŒ€ == 'ì êµ°' && ëŒ€ìƒ.x == 12)) {
                ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([{x: ì´ë™ìœ„ì¹˜[0], y: ì´ë™ìœ„ì¹˜[1], ê³ ìœ ì´ë¦„: ëŒ€ìƒ.ê³ ìœ ì´ë¦„, íƒ€ì…: ëŒ€ìƒ.íƒ€ì…, ì¢…ì¡±: ëŒ€ìƒ.ì¢…ì¡±, íŒ€: ëŒ€ìƒ.íŒ€, ì²´ë ¥: ëŒ€ìƒ.ì²´ë ¥}]);
                ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([{x: ì›ë˜ìœ„ì¹˜.x, y: ì›ë˜ìœ„ì¹˜.y, html: ''}])
            }
            else {console.log(ëŒ€ìƒ.ê³ ìœ ì´ë¦„ + 'ì´ ì˜ëª»ëœ ìœ„ì¹˜ë¡œ ì´ë™ì„ ì‹œë„í•˜ê³  ìˆìŠµë‹ˆë‹¤.')}
        }


        async function í–‰ë™ê³„ì‚°(ëŒ€ìƒ, íŒ€) {
            if (íŒ€ == 'ëª¨ë‘') {
                //console.log("ì´ì „");
                for (var h = 0; h < ê²Œì„í˜„í™©.ë€íŒ.length; h++) {
                    ê²Œì„í˜„í™©.ë€íŒ[h] = ['', 0];
                }
                for (var i = 0; i < Object.keys(ëŒ€ìƒ).length; i++) {
                    const ì„¤ì •ìš”ì†Œ = ëŒ€ìƒ[Object.keys(ëŒ€ìƒ)[i]];
                    //console.log(ì„¤ì •ìš”ì†Œ.x + '/' + ì„¤ì •ìš”ì†Œ.y + '/' + ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„)
                    if (ì„¤ì •ìš”ì†Œ.íƒ€ì… !== 'obj' && !(ì„¤ì •ìš”ì†Œ.y == 1 && ì„¤ì •ìš”ì†Œ.x == 1 && ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°')) {
                        //ì—…ë°ì´íŠ¸ë²„ì „
                        if (ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - ((ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 1 : -1) + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] == '') {//ì „ë©´ì— ë¬¼ì²´ ì—†ìŒ
                            if (ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') {
                                if (ì„¤ì •ìš”ì†Œ.y > 1 && ì„¤ì •ìš”ì†Œ.x !== 1 && //ì ì˜ ìœ„ì¹˜ ì˜ˆìƒê³¼ ëŒ€ì‘
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 1 + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] !== '' &&
                                    !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 1 + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes(ì„¤ì •ìš”ì†Œ.íŒ€)) &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] === ''
                                    && !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 1 + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes('ê¸°ì§€'))) {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'up');
                                } else if (ì„¤ì •ìš”ì†Œ.y < ê²Œì„í˜„í™©.ë§µí¬ê¸°[1] && ì„¤ì •ìš”ì†Œ.x !== 1 &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 1 + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] !== '' &&
                                    !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 1 + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes(ì„¤ì •ìš”ì†Œ.íŒ€)) &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] === ''
                                    && !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 1 + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes('ê¸°ì§€'))) {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'down');
                                    //alert('1down')
                                } else if (ì„¤ì •ìš”ì†Œ.y < ê²Œì„í˜„í™©.ë§µí¬ê¸°[1] && ì„¤ì •ìš”ì†Œ.x > 2 &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 2 + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] !== '' &&
                                    !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 2 + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes(ì„¤ì •ìš”ì†Œ.íŒ€)) &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] === ''
                                    && !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 2 + ì„¤ì •ìš”ì†Œ.y * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes('ê¸°ì§€'))) {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'down');
                                    //alert('2down');
                                } else if (ì„¤ì •ìš”ì†Œ.y > 1 && ì„¤ì •ìš”ì†Œ.x > 2 &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 2 + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] !== '' &&
                                    !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 2 + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes(ì„¤ì •ìš”ì†Œ.íŒ€)) &&
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] === ''
                                    && !(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - 2 + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes('ê¸°ì§€'))) {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'up');

                                } else {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, (ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 'left' : 'right');
                                    if ((ì„¤ì •ìš”ì†Œ.x === 1 && ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') || (ì„¤ì •ìš”ì†Œ.x === 12 && ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì êµ°')) //ëª©ì ì§€ ë„ë‹¬ì‹œ
                                    {
                                        //ì ìˆ˜íšë“ì‹œìŠ¤í…œ
                                        ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] = ['ì‹ ', -1000];
                                    }
                                }
                            }
                            else {
                                //ì£¼ë³€ì— ì ì´ ì—†ìŒ
                                ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, (ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 'left' : 'right');
                                if ((ì„¤ì •ìš”ì†Œ.x == 1 && ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') || (ì„¤ì •ìš”ì†Œ.x == 12 && ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì êµ°')) //ëª©ì ì§€ ë„ë‹¬ì‹œ
                                {
                                    //ì ìˆ˜íšë“ì‹œìŠ¤í…œ
                                    ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] = ['ì‹ ', -1000];
                                }
                            }


                        } else {//ì •ë©´ì— ë¬¼ì²´ì´ ìˆìŒ
                            if (!(ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - ((ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 1 : -1) + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]]).includes(ì„¤ì •ìš”ì†Œ.íŒ€)) {
                                if (ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x - ((ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 1 : -1) + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]].includes('ê¸°ì§€')) {//ê¸°ì§€ë¼ë©´
                                    //ì ìˆ˜íšë“ì‹œìŠ¤í…œ
                                    if (ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] === '') {ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'up');}
                                }//ê³µê²©ëª¨ì…˜ê³¼ ì²˜ë¦¬

                                HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation = 'jump 0.2s ease-in-out';
                                if (ì„¤ì •ìš”ì†Œ.íƒ€ì… == 'chaw') {
                                    HTML(`#w_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.transform = ((ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 'rotate(-130deg)' : 'rotate(130deg)');
                                }
                                ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x - ((ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 1 : -1) + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] = [ì„¤ì •ìš”ì†Œ.íŒ€, -1 * (ìºë¦­í„°íŠ¹ì§•ì„¤ì •[ì„¤ì •ìš”ì†Œ.ì¢…ì¡±].ê³µê²©ë ¥)];
                                setTimeout(() => {
                                    if (HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`)) {
                                        HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation = '';
                                        if (ì„¤ì •ìš”ì†Œ.íƒ€ì… == 'chaw') {
                                            HTML(`#w_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.transform = ((ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 'rotate(-45deg)' : 'rotate(45deg)');
                                        }
                                    }
                                }, 500);//ê³µê²©ëª¨ì…˜ ì™„ë£Œ
                            }
                            else {//ì •ë©´ì˜ ëŒ€ìƒì´ ì•„êµ°ì´ë¼ë©´
                                if (ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 2) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] == '' && ì„¤ì •ìš”ì†Œ.y !== 1) {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'up');
                                }
                                else if (ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] == '' && ì„¤ì •ìš”ì†Œ.y !== ê²Œì„í˜„í™©.ë§µí¬ê¸°[1]) {
                                    ì˜¤ë¸Œì íŠ¸ì´ë™(ì„¤ì •ìš”ì†Œ, 'down');
                                }//ê²½ë¡œì²˜ë¦¬
                            }
                        }
                        //ê´€ë ¨ì½”ë“œì²˜ë¦¬ì™„ë£Œ
                    }
                }
                for (var j = 0; j < Object.keys(ëŒ€ìƒ).length; j++) {
                    const ì„¤ì •ìš”ì†Œ = ëŒ€ìƒ[Object.keys(ëŒ€ìƒ)[j]];
                    //console.log(ì„¤ì •ìš”ì†Œ)
                    if (ì„¤ì •ìš”ì†Œ.íƒ€ì… !== "obj") {
                        //console.log(JSON.stringify(ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„]) + 'â–¶'+JSON.stringify(ì„¤ì •ìš”ì†Œ));
                        //console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ +'/'+ ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]])
                        if (ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]][1] !== 0) {
                            if (!(ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]][0] === ì„¤ì •ìš”ì†Œ.íŒ€)) {
                                ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„].ì²´ë ¥ += ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]][1];
                                //HTML(`#tile_${ì„¤ì •ìš”ì†Œ.x}_${ì„¤ì •ìš”ì†Œ.y}`).innerHTML += `<div class = "damageShow">ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]][1]</div>`;
                            }
                            else if ((ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]][0] === 'ì‹ ')) {
                                ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„].ì²´ë ¥ += ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]][1];
                            }
                            if (ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„].ì²´ë ¥ < 0) {ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„].ì²´ë ¥ = 0; ì„¤ì •ìš”ì†Œ.ì²´ë ¥ = 0;}
                            HTML(`#ì²´ë ¥ë°”_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).innerHTML = "â—†".repeat(ì„¤ì •ìš”ì†Œ.ì²´ë ¥);
                            ê²Œì„í˜„í™©.ë€íŒ[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] = ['', 0];
                            //console.log(ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ + '..' + ì„¤ì •ìš”ì†Œ.ì²´ë ¥)
                            if (ì„¤ì •ìš”ì†Œ.ì²´ë ¥ === 0) {
                                delete ê²Œì„í˜„í™©.ìºë¦­í„°[ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„];
                                //alert(HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation);
                                if (ì„¤ì •ìš”ì†Œ.x === 12 || ì„¤ì •ìš”ì†Œ.x === 1) {
                                    ê²Œì„í˜„í™©.ì ìˆ˜[ì„¤ì •ìš”ì†Œ.íŒ€] += 24;
                                    ì ìˆ˜íŒì„¤ì •();
                                    HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation = 'ì¹¨ì…ì„±ê³µ 0.5s ease-in-out';
                                }
                                else if (!(HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation.includes('ì¹¨ì…ì„±ê³µ'))) {
                                    ê²Œì„í˜„í™©.ì ìˆ˜[(ì„¤ì •ìš”ì†Œ.íŒ€ == 'ì•„êµ°') ? 'ì êµ°' : 'ì•„êµ°'] += 4;
                                    ì ìˆ˜íŒì„¤ì •();
                                    HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation = '';
                                    HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.animation = `ì£½ìŒ${ì„¤ì •ìš”ì†Œ.íŒ€} 0.5s ease-in`;
                                }
                                console.log('ì£½ìŒ / ' + ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„ + ' ' + ì„¤ì •ìš”ì†Œ.íŒ€);
                                if (ì„¤ì •ìš”ì†Œ.ì¢…ì¡± == 'ê°œë‚˜ë¦¬í­íƒ„ë³‘') {í­ë°œ(HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).getBoundingClientRect().left, HTML(`#${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).getBoundingClientRect().top)}
                                if (ì„¤ì •ìš”ì†Œ.íƒ€ì… == 'chaw') {
                                    HTML(`#w_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.opacity = '0';
                                    HTML(`#title_${ì„¤ì •ìš”ì†Œ.ê³ ìœ ì´ë¦„}`).style.opacity = '0';
                                }
                                setTimeout(() => {
                                    HTML(`#tile_${ì„¤ì •ìš”ì†Œ.x}_${ì„¤ì •ìš”ì†Œ.y}`).innerHTML = '';
                                    ê²Œì„í˜„í™©.board[ì„¤ì •ìš”ì†Œ.x + (ì„¤ì •ìš”ì†Œ.y - 1) * ê²Œì„í˜„í™©.ë§µí¬ê¸°[0]] = '';
                                }, 490);
                                j--;
                            }

                        }
                    }
                }
                //console.log("ì™„ë£Œ");
            }
        }

        function ìµœëŒ€ê³µì•½ìˆ˜(a, b) {
            while (b !== 0) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }

        function ì ìˆ˜íŒì„¤ì •() {
            const ì´ì ìˆ˜ = ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° + ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°;
            HTML("#score_ì êµ°").style.width = `${(ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° / ì´ì ìˆ˜) * 100}%`;
            HTML("#score_ì êµ°").style.flexBasis = `${(ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° / ì´ì ìˆ˜) * 100}%`;
            HTML("#score_ì êµ°").innerHTML = `${((ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° / ì´ì ìˆ˜) * 100) | 0}`;
            HTML("#score_ì•„êµ°").innerHTML = `${((ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° / ì´ì ìˆ˜) * 100) | 0}`;
            //console.log(ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° +'/'+ ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°)
        }
        // ì¸ê²Œì„
        async function ê²Œì„ì´ˆê¸°ì„¤ì •() {
            ë³´ë“œíŒìƒì„±(ê²Œì„í˜„í™©.ë§µí¬ê¸°[0], ê²Œì„í˜„í™©.ë§µí¬ê¸°[1]);
            console.log(ê²Œì„í˜„í™©.object[0].ì²´ë ¥ + '/' + ê²Œì„í˜„í™©.object[1].ì²´ë ¥)
            while (ê²Œì„í˜„í™©.object[0].ì²´ë ¥ > 0 && ê²Œì„í˜„í™©.object[1].ì²´ë ¥ > 0) {
                HTML("#ingame_world").innerHTML += `<div class="waveAlert" id="waver">ì›¨ì´ë¸Œ ${ê²Œì„í˜„í™©.ì›¨ì´ë¸Œ}</div>`;
                await new Promise(resolve => setTimeout(resolve, 2490));
                HTML("#ingame_world").innerHTML = HTML("#ingame_world").innerHTML.replace(`<div class="waveAlert" id="waver">ì›¨ì´ë¸Œ ${ê²Œì„í˜„í™©.ì›¨ì´ë¸Œ}</div>`,"")
                ì˜¤ë¸Œì íŠ¸ê´€ë¦¬(ê²Œì„í˜„í™©.object);
                await new Promise((resolve) => {
                    const ê²Œì„ì§„í–‰ë°˜ë³µ = setInterval(() => {
                        í–‰ë™ê³„ì‚°(ê²Œì„í˜„í™©.ìºë¦­í„°, 'ëª¨ë‘');
                        if (Object.keys(ê²Œì„í˜„í™©.ìºë¦­í„°).length === 2) {
                            clearInterval(ê²Œì„ì§„í–‰ë°˜ë³µ);
                            resolve();
                        }
                    }, 1000);
                });

                let ì ìˆ˜ê³µì•½ìˆ˜ = ìµœëŒ€ê³µì•½ìˆ˜(ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°, ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°);
                ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° /= ì ìˆ˜ê³µì•½ìˆ˜;
                ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° /= ì ìˆ˜ê³µì•½ìˆ˜;
                ì ìˆ˜íŒì„¤ì •();
                let ì´ì „ì ìˆ˜ = {ì•„êµ°:ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°,ì êµ°:ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°};
                if (ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° > 4 || ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° > 4) {
                    //alert('ë‹¨ì¶•')
                    //ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° *= 1.5/Math.abs(5-ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°-ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°); 
                    //ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° *= 1.5/Math.abs(5-ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°-ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°);
                    console.log(ê²Œì„í˜„í™©.ì ìˆ˜)
                    if (ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° > ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°) {
                        ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° = 1 * (ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° / ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°);
                        ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° = 1;
                    }
                    else {
                        console.log(ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° / ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°)
                        ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° = 1 * (ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° / ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°);
                        ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° = 1;
                    }
                    ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° = ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ° | 0;
                    ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° = ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ° | 0;
                    if(ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°==ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°)
                    {
                        if(ì´ì „ì ìˆ˜.ì•„êµ° > ì´ì „ì ìˆ˜.ì êµ°)
                        {
                            ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°++;
                        }
                        else if(ì´ì „ì ìˆ˜.ì•„êµ° < ì´ì „ì ìˆ˜.ì êµ°)
                        {
                            ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°++;
                        }
                    }
                }
                console.log(ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ - ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°)
                ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ -= ê²Œì„í˜„í™©.ì ìˆ˜.ì êµ°;
                ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥ -= ê²Œì„í˜„í™©.ì ìˆ˜.ì•„êµ°;
                console.log(ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥)

                if (ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ < 0) {ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ = 0;}
                if (ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥ < 0) {ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥ = 0;}
                await new Promise(resolve => setTimeout(resolve, 1000));
                //console.log(ê²Œì„í˜„í™©.ìºë¦­í„°);
                ì˜¤ë¸Œì íŠ¸ê´€ë¦¬([ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€, ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€]);
                await new Promise(resolve => setTimeout(resolve, 1000));
                ê²Œì„í˜„í™©.ì›¨ì´ë¸Œ++;
                ê²Œì„í˜„í™©.ì ìˆ˜ = {ì êµ°: 2, ì•„êµ°: 2};
                ê²Œì„í˜„í™©.object[0].ì²´ë ¥ = ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥;
                ê²Œì„í˜„í™©.object[1].ì²´ë ¥ = ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥;
                ì ìˆ˜íŒì„¤ì •();
                // alert('ì›¨ì´ë¸Œ ë‹¤ìŒ')
            }
            //console.log('ê°œìƒˆêº„')
            if (ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ == 0 && ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥ > 0) {
                if(ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥-ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ > 3)
                {HTML("#ingame_world").innerHTML += `<div class="winOrnot">ì••ë„ì  ëŒ€ìŠ¹ğŸ¤©</div>`;}
                else if(ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥-ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ > 1 )
                {HTML("#ingame_world").innerHTML += `<div class="winOrnot">í‰ë²”í•œ ìŠ¹ë¦¬ğŸ¥³</div>`;}
                else{HTML("#ingame_world").innerHTML += `<div class="winOrnot">ì•„ìŠ¬ì•„ìŠ¬í•œ ìŠ¹ë¦¬ğŸ˜…</div>`;}
            }
            else if (ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥ == 0 && ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ > 0) {
                if(ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥-ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ < -3)
                {HTML("#ingame_world").innerHTML += `<div class="winOrnot">ì²˜ì°¸í•œ ëŒ€íŒ¨ğŸ˜±</div>`;}
                else if(ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥-ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ < -1 )
                {HTML("#ingame_world").innerHTML += `<div class="winOrnot">ìŠ¬í”ˆ íŒ¨ë°°ğŸ˜“</div>`;}
                else{ HTML("#ingame_world").innerHTML += `<div class="winOrnot">ì•„ê¹Œìš´ íŒ¨ë°°ğŸ˜ª</div>`;}
            }
            else if (ê²Œì„í˜„í™©.ìºë¦­í„°.ì êµ°ê¸°ì§€.ì²´ë ¥ == 0 && ê²Œì„í˜„í™©.ìºë¦­í„°.ì•„êµ°ê¸°ì§€.ì²´ë ¥ == 0) {
                HTML("#ingame_world").innerHTML += `<div class="winOrnot">ë™ì ğŸ˜³</div>`;
            }
            else {alert('ìŠ¹ë¶€íŒì • ì˜¤ë¥˜ë°œìƒ')}
        }

        ê²Œì„ì´ˆê¸°ì„¤ì •();
    </script>
</body>
